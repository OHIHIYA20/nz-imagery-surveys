
dist: trusty
sudo: true

matrix:
  include:

    - addons:
        postgresql: 9.2
        apt:
          packages:
            - postgresql-9.2-pgtap
      env:
        - POSTGRESQL=9.2

    - addons:
        postgresql: 9.3
        apt:
          packages:
            - postgresql-9.3-pgtap
      env:
        - POSTGRESQL=9.3

    - addons:
        postgresql: 9.4
        apt:
          packages:
            - postgresql-9.4-pgtap
      env:
        - POSTGRESQL=9.4

    - addons:
        postgresql: 9.5
        apt:
          packages:
            - postgresql-9.5-pgtap
      env:
        - POSTGRESQL=9.5

    - addons:
        postgresql: 9.6
        apt:
          packages:
            - postgresql-9.6-pgtap
      env:
        - POSTGRESQL=9.6

before_script:
  - cd tests
  - psql -U postgres -c 'CREATE DATABASE travis_ci_test;' -U postgres
  - psql -U postgres -d travis_ci_test -c 'CREATE EXTENSION postgis;'
  - psql -U postgres -d travis_ci_test -c 'CREATE EXTENSION pgtap;' 
  - psql -U postgres -d travis_ci_test -af ../sql/01-create_schema.sql
#   - psql -U postgres -d travis_ci_test -af insert_test_data.sql

script:
  - psql -U postgres -d travis_ci_test -Xf base.sql
